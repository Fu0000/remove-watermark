# 后台页面框架规范（Next.js + Ant Design Pro，v1.0）

## 1. 目标
- 定义运营后台最小可用框架，支撑 FR-012 落地。
- 确保后台操作可追踪、可审计、可回放。

## 2. 范围
- 任务查询/重放、套餐管理、风险台账、Webhook 投递排障。
- 后台仅内网可访问。

## 3. 规则

### 3.1 技术与目录
- 技术栈：`Next.js + Ant Design Pro + TypeScript`。
- 目录固定：`apps/admin-console/src/{pages,features,components,services,auth}`。

### 3.2 RBAC 规则
| 角色 | 权限 |
|---|---|
| admin | 全量查看与高危操作 |
| operator | 查询、重试、重放、低风险配置 |
| auditor | 只读查询与审计导出 |

- 页面、按钮、接口三层权限都必须校验。

### 3.3 模块域
| 模块 | 核心能力 | 关键字段 |
|---|---|---|
| 任务管理 | 查询、筛选、重放 | `taskId/userId/status/traceId` |
| 套餐管理 | 套餐配置、价格、权益 | `planId/quota/price/status` |
| 风险台账 | 风险记录、状态变更 | `riskId/severity/status/owner` |
| Webhook 运维 | 投递查询、失败重试 | `endpointId/deliveryId/retryCount` |

### 3.4 表格与操作规范
- 所有列表必须支持：分页、筛选、排序、时间区间。
- 高危操作（重放/删除/降级）必须二次确认。
- 重放操作必须提示幂等语义，避免重复触发。

### 3.5 指标看板
- 展示 `MET-001~MET-005`、`NFR-001~NFR-007` 关键指标。
- 默认维度：日期、平台、任务类型、质量档位、错误码。

## 4. 模板/示例

### 4.1 后台页面路由模板
```text
/apps/admin-console/src/pages/
  /tasks
  /plans
  /risks
  /webhooks
  /audit
```

### 4.2 高危操作确认文案模板
- 标题：`确认重放任务`。
- 内容：`本操作将重新入队任务并产生新的处理成本，请确认已核对失败原因。`
- 必填：`操作原因`（写入 `audit_logs`）。

## 5. 验收
- 未授权用户无法访问后台页面与接口。
- 所有高危操作均能在审计日志中追溯。
- FR-012 最小集（任务查询、异常重放、套餐管理）可演示。

## 6. 版本记录
| 版本 | 日期 | 说明 |
|---|---|---|
| v1.0 | 2026-02-19 | 首版后台页面框架规范 |
