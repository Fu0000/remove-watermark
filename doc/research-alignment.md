# 深度调研结论对齐矩阵（v1.0）

## 1. 文档信息

| 字段 | 内容 |
|---|---|
| 文档名称 | Research Alignment |
| 版本 | v1.0 |
| 状态 | Ready for Execution |
| 调研来源 | `/Users/codelei/Downloads/deep-research-report.md` |
| 产品真源 | `/Users/codelei/Documents/ai-project/remove-watermark/doc/prd.md` |
| 接口真源 | `/Users/codelei/Documents/ai-project/remove-watermark/doc/api-spec.md` |
| 架构真源 | `/Users/codelei/Documents/ai-project/remove-watermark/doc/tad.md` |
| 更新时间 | 2026-02-19 |

## 2. 目标、范围、规则、示例、验收

### 2.1 目标
- 将深度调研报告中的关键结论映射到现有文档体系。
- 消除路线、术语、MVP 边界、风险口径冲突。
- 输出可执行且可追踪的落地结论。

### 2.2 范围
- 覆盖：技术路线、模型许可、渲染链路、工程化、成本与容量、合规风控。
- 不覆盖：代码实现细节与具体供应商采购流程。

### 2.3 规则
- 统一基线：`MVP(v1.0)=图片+视频`，`V1.1=PDF/PPT 图片页`。
- 风险策略：记录不阻断（必须可追踪）。
- 推理策略：Node 控制面 + Triton 推理面。

### 2.4 示例
- 调研结论“视频模型存在非商用许可风险”映射为：
  - `prd.md` 风险台账新增“许可风险项”。
  - `tad.md` 增加“研究/商用双执行配置”。
  - `api-spec.md` 增加 `riskFlags` 能力透传。

### 2.5 验收
- 每条调研结论都有目标文档落点与验收项。
- 任一风险点都具备替代路径与触发条件。

## 3. 调研结论映射矩阵（核心）

| 调研结论 | 采纳策略 | 落地文档 | 验收项 |
|---|---|---|---|
| 最佳实践是“分割/检测 + 修复”流水线 | 采纳 | `tad.md`, `api-spec.md`, `diagrams.md` | 运行时链路与时序图体现分层流水线 |
| 图片主线以 LaMa 为快速路径 | 采纳 | `plan.md`, `tad.md`, `project-constraints.md` | 模型路由中有 FAST 路径定义 |
| 视频需强调时域一致性，逐帧方案有闪烁风险 | 采纳 | `prd.md`, `tad.md`, `diagrams.md` | 风险台账含“逐帧闪烁”与降级策略 |
| 文档链路应先渲染再处理再封装 | 采纳 | `prd.md`, `plan.md`, `project-constraints.md` | V1.1 渲染链路与失败回退明确 |
| PPT 建议 LibreOffice 转 PDF，存在保真风险 | 采纳 | `prd.md`, `project-constraints.md` | 有“转换失败回退策略”章节 |
| 许可风险（AGPL/CC BY-NC/非商用）需前置治理 | 采纳（记录不阻断） | `prd.md`, `project-constraints.md` | 风险级别、替代方案、触发条件齐备 |
| 工程上应异步队列+中间产物 TTL 清理 | 采纳 | `tad.md`, `database-design.md` | 队列、TTL、清理策略具备 |
| 小程序不宜本地大模型推理，云端优先 | 采纳 | `prd.md`, `tad.md` | 部署和终端能力边界清晰 |
| 成本需按“GPU秒 + 队列深度”做容量规划 | 采纳 | `tad.md`, `project-constraints.md` | 容量阈值和告警门限可执行 |
| 严格商用白名单+发布阻断闸门应立即启用 | 暂不采纳（当前阶段） | `project-constraints.md`, `prd.md` | 风险台账存在且“记录不阻断”策略被明确 |

## 4. 关键冲突与解决结果

| 冲突项 | 原状态 | 统一后 |
|---|---|---|
| MVP 边界 | `plan.md` 含 PDF/PPT；`prd.md` 为 V1.1 | 统一以 `prd.md` 为准：v1.0 仅图片+视频 |
| 对象存储术语 | 存在 S3/OSS/MinIO 混用 | 统一为 MinIO（S3 兼容实现） |
| 推理架构表述 | 文档中未明确 Triton 的角色边界 | 统一为 Node 控制面 + Triton 推理面 |
| 许可风险管理 | 仅有零散描述 | 新增“技术与许可风险台账”规范 |

## 5. 技术与许可风险台账（记录不阻断）

| 风险ID | 风险项 | 级别 | 影响 | 触发条件 | 缓解/替代 |
|---|---|---|---|---|---|
| R-LIC-001 | 视频高质量模型非商用许可 | 高 | 商用上线风险 | 外部发布前未完成授权核验 | 用可商用实现替代或购买授权 |
| R-LIC-002 | 文档渲染组件许可不兼容 | 中 | 分发与合规风险 | 端侧打包或二次分发时 | 锁版本+法律审查+可替换渲染器 |
| R-TECH-001 | 逐帧视频修复闪烁 | 中 | 质量与口碑风险 | 使用帧级修复链路 | 引入时域模型或提示标准档 |
| R-TECH-002 | PPT 转换保真差异 | 中 | 文档结果偏差 | 字体/模板不兼容 | 提供失败回退与提示上传 PDF |
| R-COST-001 | 高质量队列成本失控 | 中 | 毛利受损 | 高峰期高质量任务激增 | 任务分档限流+配额策略 |

## 6. 渲染链路决策闭环

### 6.1 统一决策
- V1.1 文档链路采用：`PPT/PPTX -> LibreOffice(headless) -> PDF -> 渲染页图 -> 图像修复 -> 输出 PDF/ZIP`。
- 若转换失败或保真异常：
  - 返回标准错误码。
  - 提示用户上传 PDF 源文件重试。

### 6.2 实施约束
- 渲染引擎与版本必须在环境能力接口中可查询。
- 同一任务内渲染器版本固定，避免结果不一致。

## 7. 追踪关系（结论 -> 文档 -> 验收）

| 结论ID | 目标文档章节 | 验收方法 |
|---|---|---|
| RA-001 | `tad.md` 运行时视图 | 时序链路包含检测->修复->事件发布 |
| RA-002 | `api-spec.md` 能力接口与任务策略 | `/v1/system/capabilities` 响应包含 models/renderers |
| RA-003 | `prd.md` 风险台账与回退策略 | 评审中可逐项追踪风险处置 |
| RA-004 | `database-design.md` 生命周期策略 | TTL 与清理策略可执行 |
| RA-005 | `webhook.md` payload 扩展 | `executionProfile/riskFlags` 字段存在且可选 |

## 8. 无卡点清单（当前）

1. MVP 边界统一为图片+视频。
2. MinIO 术语统一完成。
3. 推理架构固定为 Node + Triton。
4. 风险台账落地并可追踪（不阻断发布）。
5. 渲染链路失败回退有规范。
6. 事件与 webhook 字段可透传风险标签。

### 8.1 仍需业务决策项（若有）
- 当前无阻断上线的新增业务决策项。
- 可选后续决策：是否启用“严格商用白名单+发布阻断闸门”（影响 `project-constraints.md`、`prd.md` 的发布策略章节，不影响现有开发主线）。

## 9. 版本记录

| 版本 | 日期 | 说明 |
|---|---|---|
| v1.1 | 2026-02-19 | 增补“暂不采纳项”与“仍需业务决策项”，完善调研结论采纳边界说明 |
| v1.0 | 2026-02-19 | 首版调研对齐矩阵，完成结论映射、冲突归并、风险台账与闭环追踪 |
